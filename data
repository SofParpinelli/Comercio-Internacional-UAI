import re

# Pegá acá tu texto de materias y correlativas
raw_data = """1° año
Teoría Política 1
Historia de las Relaciones Internacionales Contemporáneas
Ingles Nivel 1
Teoría Económica
Problemática de las Relaciones Internacionales
Política y Derecho
Teoría Sociológica 1

2° año
Teoría Política 2 (correlativas: Teoría Política 1)
Inglés Nivel 2 (correlativa: Ingles Nivel 1)
Política Económica (correlativa; Teoría Económica)
Relaciones Internacionales (correlativa: Problemática de las Relaciones Internacionales)
Epistemología
Teoría Sociológica 2 (correlativa: Teoría Sociológica 1)
Historia Política Latinoamericana

3° año
Teoría Política 3 (correlativa: Teoría Política 2)
Historia Política Argentina (correlativa: Historia Política Latinoamericana)
Ingles Nivel 3 (Correlativa: Ingles Nivel 2)
Economía Internacional (correlativa: Política Económica)
Integración y Cooperación Latinoamericana (correlativa: Relaciones Internacionales)
Metodología de la Investigación en las Ciencias Sociales (Correlativa: Epistemología)
Política Comparada (correlativa: Relaciones Internacionales)

4° año
Derecho Internacional Publico (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2)
Ingles Nivel 4 (correlativa; Ingles Nivel 3)
Frances Nivel 1
Finanzas Internacionales (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Economía Internacional)
Teoría de las Relaciones Internacionales (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana)
Comercio Exterior (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Economía Internacional, Integración y Cooperación Latinoamericana)
Política Internacional (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana)
Historia de las Relaciones Internacionales Latinoamericanas y Argentinas (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana)

5° año
Política Internacional Argentina (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Historia Política Argentina, Política Internacional)
Francés Nivel 2 (Correlativa: Frances Nivel 1)
Politica Internacional Latinoamericana (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Integración y Cooperación Latinoamericana, Política Internacional)
Electiva 1 (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Economía Internacional, Integración y Cooperación Latinoamericana, Metodología de la Investigación en las Ciencias Sociales, Política Comparada) 
Taller (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Metodología de la Investigación en las Ciencias Sociales)
Derecho Consular y Diplomático ((correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Derecho Internacional Publico)
Electiva 2 (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Economía Internacional, Integración y Cooperación Latinoamericana, Metodología de la Investigación en las Ciencias Sociales, Política Comparada) 
Electiva 3 (correlativas: Teoría Política 1, Historia de las Relaciones Internacionales Contemporáneas, Teoría Económica, Problemática de las Relaciones Internacionales, Política y Derecho, Teoría Sociológica 1, Teoría Política 2, Política Económica, Relaciones Internacionales, Epistemología, Teoría Sociológica 2, Historia Política Latinoamericana, Economía Internacional, Integración y Cooperación Latinoamericana, Metodología de la Investigación en las Ciencias Sociales, Política Comparada) 
"""

nodes = []
links = []

current_year = ""
for line in raw_data.splitlines():
    line = line.strip()
    if not line:
        continue
    year_match = re.match(r"\d+° año", line)
    if year_match:
        current_year = line
        continue
    # Buscar correlatividades
    correlativas = []
    if "correlativa" in line:
        materia, corr_str = line.split("(", 1)
        materia = materia.strip()
        corr_text = re.findall(r"correlativas?:\s*(.+?)\)*$", corr_str.strip(), re.IGNORECASE)
        if corr_text:
            correlativas = [c.strip() for c in re.split(r",| y |;", corr_text[0])]
    else:
        materia = line.strip()

    # Crear nodo
    nodes.append({
        "id": materia,
        "grupo": current_year
    })

    # Crear enlaces de correlativas
    for corr in correlativas:
        links.append({
            "source": corr,
            "target": materia
        })

# Imprimir resultado en formato JSON (listo para usar con D3.js)
import json
print(json.dumps({
    "nodes": nodes,
    "links": links
}, indent=2, ensure_ascii=False))
